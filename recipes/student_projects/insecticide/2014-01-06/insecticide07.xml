<?xml version="1.0" encoding="ISO-8859-1"?>

<simulation name="Insecticide ecotoxicology">

	<integrator name="steps" type="UniSim::Steps">
		<parameter name="maxSteps" value="120"/> <!-- Corresponding to the number of maize growing season -->
	</integrator>
	
	<model name="calendar" type="UniSim::Calendar">
		<parameter name="initialDate" value="01/04/2013"/>
	</model>

	<model name="weather" type="UniSim::Weather">
		<model name="records" type="UniSim::Records">
			<parameter name="fileName" value="PathumthaniAgromet2013.txt"/>
			<parameter name="imposeInitialDateTime" value="no"/>  <!-- Tell the Records model not to impose its time scale on the calendar -->
		</model>
	</model>
	
	<model name="maize">
		<model name="time" type="UniSim::DayDegrees">
			<parameter name="T0" value="5"/>
		</model>
		<model name="vegetative" type="UniSim::Stage">
			<parameter name="duration" value="400"/>
			<parameter name="initialInflow" value="1"/>
		</model>
		<model name="flowering" type="UniSim::Stage">
			<parameter name="duration" value="200"/>
			<parameter name="inflow" ref="vegetative[outflow]"/>
		</model>
		<model name="senescent" type="UniSim::Stage">
			<parameter name="duration" value="300"/>
			<parameter name="inflow" ref="flowering[outflow]"/>
		</model>
	</model>
	
	<model name="applications">
		<model name="app1" type="insecticide::Application">
			<parameter name="day" value="15"/>
			<parameter name="dosage" value="3.6"/>
		</model>
		<model name="app2" type="insecticide::Application">
			<parameter name="day" value="25"/>
			<parameter name="dosage" value="5.2"/>
		</model>
		<model name="app3" type="insecticide::Application">
			<parameter name="day" value="35"/>
			<parameter name="dosage" value="6.2"/>
		</model>
		<model name="total" type="UniSim::Sum">
			<parameter name="toAdd" value="(app1[application] app2[application] app3[application])"/>
		</model>
	</model>	
	
	<model name="Concentration in technosphere">
	     <model name="glyphosateConcInSoil" type="insecticide::Compartment">
		    <parameter name="application" ref="applications/total[value]"/>
			<parameter name="proportionToTechnosphere" value="0.3"/>
	    </model>

	    <model name="glyphosateConcInAir" type="insecticide::Compartment">
		    <parameter name="application" ref="applications/total[value]"/>
		    <parameter name="proportionToTechnosphere" value="0.2"/>
	    </model>

	     <model name="glyphosateConcOnLeaf" type="insecticide::Compartment">
		    <parameter name="application" ref="applications/total[value]"/>
		    <parameter name="proportionToTechnosphere" value="0.5"/>
	     </model>
	</model>

	<model name="Degradation in soil">
		<model name="glyphosateInSoil" type="insecticide::Substance">
			<parameter name="inflow" ref="glyphosateConcInSoil[concentration]"/>
			<parameter name="degradationConstant" value="0.1"/>
			<parameter name="fractionformation" value="0.6"/>
			<parameter name="degradationConstant_2" value="0.1"/>
			<parameter name="fractionformation_2" value="0.4"/>
		</model>
		<model name="AMPAinSoil" type="insecticide::Substance">
			<parameter name="inflow" ref="glyphosateInSoil[outflow]"/>
			<parameter name="degradationConstant" value="0."/>
			<parameter name="fractionformation" value="0."/>
			<parameter name="degradationConstant_2" value="0.01"/>
			<parameter name="fractionformation_2" value="1"/>
			
		</model>
		<model name="POEAinSoil" type="insecticide::Substance">
			<parameter name="inflow" ref="glyphosateInSoil[outflow]"/>
			<parameter name="degradationConstant" value="0.1"/>
			<parameter name="fractionformation" value="0.4"/>
			<parameter name="degradationConstant_2" value="0.001"/>
			<parameter name="fractionformation_2" value="1"/>
		</model>
	</model>
	
	<model name="Hazard Quotient index in soil">
		<model name="glyphosate HQ in soil" type="insecticide::HazardQuotient">
		    <parameter name="concentration" ref="glyphosateInSoil[concentration]"/>
		    <parameter name="lowestAvailableNOAEL" value="0.75"/>
		</model>
		<model name="AMPA HQ in soil" type="insecticide::HazardQuotient">
		    <parameter name="concentration" ref="AMPAinSoil[concentration]"/>
		    <parameter name="lowestAvailableNOAEL" value="0.75"/>
		</model>
		<model name="POEA HQ in soil" type="insecticide::HazardQuotient">
		    <parameter name="concentration" ref="POEAinSoil[concentration]"/>
		    <parameter name="lowestAvailableNOAEL" value="0.75"/>
		</model>
		<model name="Reference value" type="insecticide::HazardQuotient">		    
		    <parameter name="RV" value="1"/>
		</model>
	</model>
	
	<model name="Plant and Leaf Volatilization">
		<model name="glyphosate volatilized" type="insecticide::VolatilizationPlantLeaf">
		    <parameter name="inflow" ref="glyphosateConcOnLeaf[application]"/>
		    <parameter name="VP" value="5.73e-8"/>
			<parameter name="dosage" value="360"/>
			<parameter name="Ea" value="95"/>
			<parameter name="R" value="2"/>
			<parameter name="Tr" value="299"/>
			<parameter name="Ta" value="400"/>
		</model>
	</model>

	
	
	<output type="plot">
		<parameter name="title" value ="Weather"/>
		<trace label="Julian day number" value="calendar[dayOfYear]"/>
		<trace label="Average temperature (C)" value="weather[Tavg]"/>
		<trace label="Minimum temperature (C)" value="weather/records[Tmin]"/>
		<trace label="Maximum temperature (C)" value="weather/records[Tmax]"/>
		<trace label="Rainfall (mm)" value="weather/records[Rain]"/>
	</output>

	<output type="plot">
		<parameter name="title" value="Maize development"/>
		<trace label="Julian day number" value="calendar[dayOfYear]"/>
		<trace label="Vegetative" ref="vegetative[value]"/>
		<trace label="Flowering" ref="flowering[value]"/>
		<trace label="Senescent" ref="senescent[value]"/>
	</output>

	<output type="plot">
		<parameter name="title" value="Pesticide concentration in soil (g/ha)"/>
		<trace label="Julian day number" value="calendar[dayOfYear]"/>
		<trace label="Glyphosate (g/ha)" ref="glyphosateInSoil[concentration]"/>
		<trace label="AMPA (g/ha)" ref="AMPAinSoil[concentration]"/>
		<trace label="POEA (g/ha)" ref="POEAinSoil[concentration]"/>
		<trace label="AMPA in" ref="AMPAinSoil[inflow]"/>
		<trace label="AMPA out" ref="AMPAinSoil[outflow]"/>
	</output>
	
	<output type="table">
       <parameter name="fileName" value ="Pesticide_concentration_in_soil.txt"/>
       <trace label="Julian day number" ref="calendar[dayOfYear]"/>
       <trace label="Glyphosate (g/ha)" ref="glyphosateInSoil[concentration]"/>
       <trace label="AMPA (g/ha)" ref="AMPAinSoil[concentration]"/>
	   <trace label="POEA (g/ha)" ref="POEAinSoil[concentration]"/>
    </output>
	
	<output type="plot">
		<parameter name="title" value="Soil risk assessment"/>
		<trace label="Julian day number" value="calendar[dayOfYear]"/>
		<trace label="Glyphosate" ref="Glyphosate HQ in soil[HQ]"/>
		<trace label="AMPA" ref="AMPA HQ in soil[HQ]"/>
		<trace label="POEA" ref="POEA HQ in soil[HQ]"/>
		<trace label="Reference line" ref="Reference value[ReferenceValue]"/>		
	</output>
	
	<output type="table">
       <parameter name="fileName" value ="Soil_risk_assessment.txt"/>
       <trace label="Julian day number" ref="calendar[dayOfYear]"/>
       <trace label="Glyphosate" ref="Glyphosate HQ in soil[HQ]"/>
       <trace label="AMPA" ref="AMPA HQ in soil[HQ]"/>
	   <trace label="POEA" ref="POEA HQ in soil[HQ]"/>
    </output>
	
	<output type="table">
       <parameter name="fileName" value ="Pesticide_volatilized_from_leaf.txt"/>
       <trace label="Julian day number" ref="calendar[dayOfYear]"/>
       <trace label="Glyphosate loss" ref="glyphosate volatilized[concentration]"/>
    </output>
	
	<output type="plot">
		<parameter name="title" value="Pesticide volatilized from leaf"/>
		<trace label="Julian day number" value="calendar[dayOfYear]"/>
		<trace label="Glyphosate loss" ref="glyphosate volatilized[concentration]"/>	
	</output>

</simulation>
