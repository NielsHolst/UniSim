<?xml version="1.0" encoding="ISO-8859-1"?>
<simulation name="Temperature setpoints">

    <integrator name="steps" type="UniSim::Steps">
		<parameter name="maxSteps" value="5760"/>
	</integrator>

	<model name="calendar" type="UniSim::Calendar">
		<parameter name="latitude" value="55"/>
		<parameter name="timeStep" value="5"/>
		<parameter name="timeUnit" value="m"/>
	</model>

	<model name="greenhouse">
		<model name="construction" type="vg::GreenhouseConstruction">
			<parameter name="glassType"  value="Single"/>
			<parameter name="lampType"  value="HPSL"/>
		</model>
	</model>
	
	<model name="rh" type="UniSim::Range">
		<parameter name="min" value="30"/>
		<parameter name="max" value="100"/>
	</model>

	<model name="moistureDeficit" type="UniSim::Range">
		<parameter name="min" value="2"/>
		<parameter name="max" value="6"/>
	</model>

	
	<model name="regulation">

		<model name="setpoints">
			
			<model name="temperature1" type="vg::TemperatureSetpoints">
				<parameter name="setMinimum" value="20"/>
				<model name="humidityIncrement" type="vg::proportionalControl">
					<parameter name="actualValue" ref="moistureDeficit[value]"/>
					<parameter name="targetValue" value="2.5"/>
					<parameter name="direction" value="floor"/>
					<parameter name="gapMultiplier" value="1.5"/>
					<parameter name="pBand" value="5"/>
					<parameter name="maxSignal" value="2"/>
				</model>
			
				<parameter name="setMaximum" value="25"/>
				<model name="humidityDecrement" type="vg::ProportionalControl">
					<parameter name="actualValue" ref="rh[value]"/>
					<parameter name="targetValue" value="70"/>
					<parameter name="direction" value="floor"/>
					<parameter name="pBand" value="100"/>
					<parameter name="maxSignal" value="1"/>
				</model>
			</model>

			<model name="temperature2" type="vg::TemperatureSetpoints">
				<parameter name="setMinimum" value="20"/>
				<model name="humidityIncrement" type="vg::proportionalControl">
					<parameter name="actualValue" ref="moistureDeficit[value]"/>
					<parameter name="targetValue" value="2.5"/>
					<parameter name="direction" value="floor"/>
					<parameter name="gapMultiplier" value="1.5"/>
					<parameter name="pBand" value="1"/>
					<parameter name="maxSignal" value="2"/>
				</model>
			
				<parameter name="setMaximum" value="25"/>
				<model name="humidityDecrement" type="vg::ProportionalControl">
					<parameter name="actualValue" ref="rh[value]"/>
					<parameter name="targetValue" value="70"/>
					<parameter name="direction" value="floor"/>
					<parameter name="pBand" value="10"/>
					<parameter name="maxSignal" value="1"/>
				</model>
			</model>
			
		</model>
	</model>

	<output type="plot">
		<parameter name="title" value = "Max. temperature setpoints (for ventilation)"/>
		<trace label="RH (%)" ref="rh[value]"/>
		<trace label="Set maximum" ref="temperature[setMaximum]"/>
		<trace label="pBand=100" ref="temperature1[maximum]"/>
		<trace label="pBand=10" ref="temperature2[maximum]"/>
	</output>


	</simulation>