<?xml version="1.0" encoding="ISO-8859-1"?>
<simulation name="sim">
	<integrator name="steps" type="UniSim::Steps">
		<parameter name="maxSteps" value="240"/>
	</integrator>
	
	<model name="calendar" type="UniSim::Calendar">
		<parameter name="initialDate" value="1/8/2001"/>
		<parameter name="latitude" value="55.5"/>
		<parameter name="timeStep" value="60"/>
		<parameter name="timeUnit" value="m"/>
	</model>
	
	<model name="outdoors" type="vg::Outdoors">
		<model name="records" type="UniSim::Records">
			<parameter name="fileName" value="sel_dk.txt"/>
		</model>
	</model>

	<model name="greenhouse">
		<model name="construction"> 
			<model name= "geometry" type="vg::ConstructionGeometry">
				<parameter name="numSpans" value ="3"/>
				<parameter name="roofPitch" value ="30"/>
			</model>
			<model name="roof1" type="vg::Cover">
				<parameter name="type" value ="s20sar"/>
			</model>
			<model name="roof2" type="vg::Cover">
				<parameter name="type" value ="s20sar"/>
			</model>
			<model name="side1" type="vg::Cover">
				<parameter name="type" value ="s20sar"/>
			</model>
			<model name="side2" type="vg::Cover">
				<parameter name="type" value ="s20sar"/>
			</model>
			<model name="end1" type="vg::Cover">
				<parameter name="type" value ="s20sar"/>
			</model>
			<model name="end2" type="vg::Cover">
				<parameter name="type" value ="s20sar"/>
			</model>
			<!--
			<model name="floor" type="vg::ConstructionCover">
			</model>
			-->
		</model>
	</model>
	
	<model name="indoors">
		<model name="transmissionCover" type="vg::TransmissionCover"/> 
		<model name="transmissionScreens" type="vg::TransmissionScreens"/> 
		<model name="radiation" type="vg::IndoorsRadiation"/> 
		<model name="temperature" type="vg::IndoorsTemperature"/> 
	</model>

	<model name="controllers">
		<model name="screens">
			<model name="maximum" type="vg::ThresholdValue">
				<parameter name="lowValue" value ="1"/>
				<parameter name="highValue" value ="0.95"/>
				<parameter name="testValue" value ="90"/>
				<parameter name="testThreshold" value ="85"/>
			</model>

			<model name="energy" type="vg::ScreenController">
				<model name="suggestedSignal" type="vg::ThresholdValue">
					<parameter name="lowValue" ref ="../../maximum[value]"/>
					<parameter name="highValue" value ="0"/>
					<parameter name="testValue" ref ="outdoors[radiation]"/>
					<parameter name="testThreshold" value ="10"/>
				</model>
				<model name="conditions" type="vg::SwitchCollection"> <!--
					<parameter name="condition" value ="allTrue"/>
					<model name="energyBalance" type="vg::EnergyScreenBalance"/> -->
				</model>
				<model name="periods" type="vg::SwitchCollection">
					<parameter name="condition" value ="someTrue"/>
					<model type="vg::TimeSwitch"/>
				</model>
			</model>


			<model name="blackout" type="vg::ScreenController">
				<model name="suggestedSignal" type="vg::ThresholdValue">
					<parameter name="lowValue" value ="0"/>
					<parameter name="highValue" ref ="../../maximum[value]"/>
					<parameter name="testValue" ref ="outdoors[radiation]"/>
					<parameter name="testThreshold" value ="0"/>
				</model>
				<model name="conditions" type="vg::SwitchCollection"/>
				<model name="periods" type="vg::SwitchCollection">
					<parameter name="condition" value ="someTrue"/>
					<model name="timeSwitch" type="vg::TimeSwitch">
						<parameter name="onDay" value="1"/>
						<parameter name="offDay" value="365"/>
						<parameter name="onTime" value="16:00"/>
						<parameter name="offTime" value="22:00"/>
					</model>
				</model>
			</model>

			<model name="blackout_following" type="vg::ScreenController">
				<parameter name="followSignal" ref ="../energy[signal]"/>
				<model name="suggestedSignal" type="vg::ThresholdValue">
					<parameter name="lowValue" value ="0"/>
					<parameter name="highValue" ref ="../../maximum[value]"/>
					<parameter name="testValue" ref ="outdoors[radiation]"/>
					<parameter name="testThreshold" value ="0"/>
				</model>
				<model name="conditions" type="vg::SwitchCollection"/>
				<model name="periods" type="vg::SwitchCollection">
					<parameter name="condition" value ="someTrue"/>
					<model name="timeSwitch" type="vg::TimeSwitch">
						<parameter name="onDay" value="1"/>
						<parameter name="offDay" value="365"/>
						<parameter name="onTime" value="16:00"/>
						<parameter name="offTime" value="22:00"/>
					</model>
				</model>
			</model>

			<model name="shade" type="vg::ScreenController">
				<model name="suggestedSignal" type="vg::ThresholdValue">
					<parameter name="lowValue" value ="0"/>
					<parameter name="highValue" ref ="../../maximum[value]"/>
					<parameter name="testValue" ref ="outdoors[radiation]"/>
					<parameter name="testThreshold" value ="20"/>
				</model>
				<model name="conditions" type="vg::SwitchCollection"/>
				<model name="periods" type="vg::SwitchCollection">
					<parameter name="condition" value ="someTrue"/>
					<model type="vg::TimeSwitch"/>
				</model>
			</model>

			<model name="shade_following" type="vg::ScreenController">
				<parameter name="followSignal" ref ="../energy[signal]"/>
				<model name="suggestedSignal" type="vg::ThresholdValue">
					<parameter name="lowValue" value ="0"/>
					<parameter name="highValue" ref ="../../maximum[value]"/>
					<parameter name="testValue" ref ="outdoors[radiation]"/>
					<parameter name="testThreshold" value ="20"/>
				</model>
				<model name="conditions" type="vg::SwitchCollection"/>
				<model name="periods" type="vg::SwitchCollection">
					<parameter name="condition" value ="someTrue"/>
					<model type="vg::TimeSwitch"/>
				</model>
			</model>

		</model>
	</model>

	<output type="table">
		<parameter name="filename" value ="dummy.txt"/>
		<trace label="Days" ref="steps[stepNumber]"/>
		<trace label="Days" ref="steps[stepNumber]"/>
	</output>
	
	<output type="plot">
		<parameter name="title" value ="Energy screen"/>
		<trace label="Days" ref="steps[stepNumber]" divisor="24"/>
		<trace label="Radiation" ref="outdoors[radiation]" divisor="100"/>
		<trace label="Signal" ref="screens/energy[signal]"/>
	</output>
	<output type="plot">
		<parameter name="title" value ="Blackout screen following"/>
		<trace label="Days" ref="steps[stepNumber]" divisor="24"/>
		<trace label="Radiation" ref="outdoors[radiation]" divisor="100"/>
		<trace label="Signal" ref="screens/blackout_following[signal]"/>
	</output>
	<output type="plot">
		<parameter name="title" value ="Shade screen following"/>
		<trace label="Days" ref="steps[stepNumber]" divisor="24"/>
		<trace label="Radiation" ref="outdoors[radiation]" divisor="100"/>
		<trace label="Signal" ref="screens/shade_following[signal]"/>
	</output>
	<output type="plot">
		<parameter name="title" value ="Blackout screen"/>
		<trace label="Days" ref="steps[stepNumber]" divisor="24"/>
		<trace label="Radiation" ref="outdoors[radiation]" divisor="100"/>
		<trace label="Signal" ref="screens/blackout[signal]"/>
	</output>
	<output type="plot">
		<parameter name="title" value ="Shade screen"/>
		<trace label="Days" ref="steps[stepNumber]" divisor="24"/>
		<trace label="Radiation" ref="outdoors[radiation]" divisor="100"/>
		<trace label="Signal" ref="screens/shade[signal]"/>
	</output>
</simulation>

