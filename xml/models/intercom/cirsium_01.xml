<?xml version="1.0" encoding="ISO-8859-1"?>
<simulation version="1.0">
    <integrator type="TimeStepLimited">
        <parameter name="maxSteps" value="365"/>
        <sequence>
            <model name="calendar"/>
            <model name="weather"/>
            <model name="field"/>
        </sequence>
    </integrator>
    <model name="calendar" type="unisim::Calendar">
        <parameter name="latitude" value="52"/>
        <parameter name="firstDate" value="1/1/2005"/>
        <parameter name="followers" value="weather"/>
    </model>
    <model name="weather" type="intercom::Weather">
        <parameter name="fileName" value="flakkebjerg 2005-06.txt"/>
        <parameter name="firstDate" value="1/1/2005"/>
        <parameter name="Tmin" value="3"/>
        <parameter name="Tmax" value="4"/>
        <parameter name="IrradiationMJ" value="6"/>
    </model>
    <model name="field" type="intercom::Community">
        <model name="cirsium" type="intercom::Plant">
            <model name="photoThermalTime" type="UniSim::PhotoThermalTime"/>
            <model name="height" type="intercom::Height">
                <parameter name="minHeight" value="0.5"/>
            </model>
            <model name="leafStemRatio" type="intercom::LeafStemRatio"/>
            <model name="leaves" type="intercom::Organ">
                <model name="area" type="intercom::Area">
                    <parameter name="initial" value="1"/>
                    <model name="specificLeafArea" type="intercom::SpecificLeafArea"/>
                    <model name="amax" type="intercom::AssimilationMaxGivenTempSla"/>
                    <model name="lightUseEfficiency" type="intercom::LightUseEfficiencyGivenTemp"/>
                    <parameter name="kDiffuse" value="0.7" comment="Same as klv"/>
                </model>
            </model>
            <model name="stem" type="intercom::Organ">
                <model name="area" type="intercom::Area">
                    <model name="amax" type="intercom::AssimilationMaxGivenTemp"/>
                    <model name="lightUseEfficiency" type="intercom::LightUseEfficiencyGivenTemp"/>
                    <parameter name="kDiffuse" value="0.3"/>
                </model>
            </model>
            <model name="flowers" type="intercom::Organ">
                <model name="area" type="intercom::Area">
                    <model name="amax" type="intercom::AssimilationMaxGivenTemp"/>
                    <model name="lightUseEfficiency" type="intercom::LightUseEfficiencyGivenTemp"/>
                    <parameter name="kDiffuse" value="0.4"/>
                </model>
            </model>
        </model>
    </model>
    <output type="intercom::file">
        <parameter name="filename" value="intercom_details.prn"/>
        <output type="table">
            <parameter name="filename" value="intercom.prn"/>
            <variable label="Daystotal" axis="x" value="calendar[daysTotal]"/>
            <variable label="Day" axis="y" value="calendar[dayInYear]"/>
            <variable label="lightAbs" axis="y" value="field[grossLightAbsorption]"/>
            <variable label="I" axis="y" value="weather[irradiationMJ]"/>
        </output>
        <output type="plot">
            <parameter name="title" value="Day length"/>
            <variable label="Day" axis="x" value="calendar[daysTotal]"/>
            <variable label="Day length" axis="y" value="calendar[dayLength]"/>
        </output>
        <output type="plot">
            <parameter name="title" value="Temperature"/>
            <variable label="Day" axis="x" value="calendar[daysTotal]"/>
            <variable label="Tavg" axis="y" value="weather[Tavg]"/>
            <variable label="Tday" axis="y" value="weather[Tday]"/>
            <variable label="I" axis="y" value="weather[irradiationMJ]"/>
        </output>
        <output type="plot">
            <parameter name="title" value="Cirsium LAI"/>
            <variable label="Day" axis="x" value="calendar[daysTotal]"/>
            <variable label="leaves" axis="y" value="cirsium/leaves/area[lai]"/>
            <variable label="stem" axis="y" value="cirsium/stem/area[lai]"/>
            <variable label="flowers" axis="y" value="cirsium/flowers/area[lai]"/>
        </output>
        <output type="plot">
            <parameter name="title" value="Cirsium height"/>
            <variable label="Day" axis="x" value="calendar[daysTotal]"/>
            <variable label="Cirsium" axis="y" value="cirsium/height[height]"/>
        </output>
        <output type="plot">
            <parameter name="title" value="Photothermal time"/>
            <variable label="Day" axis="x" value="calendar[daysTotal]"/>
            <variable label="total" axis="y" value="cirsium/photoThermalTime[total]"/>
        </output>
        <output type="plot">
            <parameter name="title" value="Photosynthesis"/>
            <variable label="Day" axis="x" value="calendar[daysTotal]"/>
            <variable label="lightAbs" axis="y" value="field[grossLightAbsorption]"/>
            <variable label="I" axis="y" value="weather[irradiationMJ]"/>
        </output>